{"version":3,"sources":["api/Api.js","App.js","custom-element/et-app.js"],"names":["strapiEndPoint","process","getTemplateById","templateId","a","axios","get","data","getContentById","contentName","contentId","console","error","url","addAuthorizationRequestConfig","getDefaultOptions","defaultBearer","log","headers","Authorization","config","defaultOptions","velocityjs","require","App","contentIdsAndTemplateIds","useState","setTemplateData","setContentData","setHtmlCode","useEffect","getTemplate","getContent","contentShape","veloResult","render","ATTRIBUTES","WidgetElement","name","oldValue","newValue","Object","values","includes","Error","this","mountPoint","document","createElement","appendChild","getAttribute","ReactDOM","HTMLElement","customElements","define"],"mappings":"8TAEMA,EAAc,UAAMC,yBAYbC,GAXI,UAAMD,4BAAN,uBAWW,uCAAG,WAAOE,GAAP,iBAAAC,EAAA,sEACJC,IAAMC,IAAN,UAAaL,4BAAb,qBAA8DE,IAD1D,uBACnBI,EADmB,EACnBA,KADmB,kBAEpBA,GAFoB,2CAAH,uDAWdC,EAAc,uCAAG,WAAOC,EAAaC,GAApB,mBAAAN,EAAA,6DACtBK,GAAgBC,GAAWC,QAAQC,MAAMH,EAAaC,GACrDG,EAFqB,UAEZb,EAFY,kDAE4CS,EAF5C,YAE2DA,EAF3D,YAE0EC,GAF1E,SAGJL,IAAMC,IAAIO,EAAKC,EAA8B,GAAI,eAH7C,uBAGnBP,EAHmB,EAGnBA,KAHmB,kBAKpBA,GALoB,2CAAH,wDAiBtBQ,EAAoB,SAACC,GAKnB,OAHJL,QAAQM,IAAI,YAVL,IAamB,eAAlBD,EACO,CACHE,QAAS,CACLC,cAAc,UAAD,OAAY,+IAI1B,IAYNL,EAAgC,WAA4C,IAA3CM,EAA0C,uDAAjC,GAAIJ,EAA6B,uDAAb,SACnEK,EAAiBN,EAAkBC,GACvC,OAAO,2BACAI,GACAC,I,eCpEPC,EAAaC,EAAQ,IA4DVC,MAvDf,YAAyD,IAA1Cf,EAAyC,EAAzCA,YAAagB,EAA4B,EAA5BA,yBACxBd,QAAQM,IAAI,+CAA+CR,EAAagB,GACxE,MAAwCC,mBAAS,MAAjD,mBAAqBC,GAArB,WACA,EAAsCD,mBAAS,MAA/C,mBAAoBE,GAApB,WACA,EAAgCF,mBAAS,MAAzC,mBAAiBG,GAAjB,WAoCA,OAlCAC,oBAAS,sBAAC,gCAAA1B,EAAA,sEACoBF,EAAgB,IADpC,cACA6B,EADA,gBAEmBvB,EAAe,SAAU,GAF5C,OAEAwB,EAFA,OAGNL,EAAgBI,GAChBH,EAAeI,GAmBXA,GAAcD,IACdpB,QAAQM,IAAI,aAAae,GACzBrB,QAAQM,IAAI,2BAA2Bc,EAAYE,cAE7CC,EAAaZ,EAAWa,OAAOJ,EAAYE,aAAcD,GAC/DH,EAAYK,IA5BV,2CAiCP,IAEC,qCACA,kDACA,6BAAkBT,QC9CpBW,EAAa,CACf3B,YAAa,cACbgB,yBAA0B,4BAGxBY,E,8KAMF,SAAyBC,EAAMC,EAAUC,GACrC,IAAKC,OAAOC,OAAON,GAAYO,SAASL,GACpC,MAAM,IAAIM,MAAJ,uCAA0CN,IAEhDO,KAAKC,YAAcN,IAAaD,GAChCM,KAAKV,W,+BAIb,WACIU,KAAKC,WAAaC,SAASC,cAAc,OACzCH,KAAKI,YAAYJ,KAAKC,YACtBD,KAAKV,W,oBAGT,WACI,IAAM1B,EAAcoC,KAAKK,aAAad,EAAW3B,aAC3CgB,EAA2BoB,KAAKK,aAAad,EAAWX,0BAC9Dd,QAAQM,IAAI,kBAAmBR,EAAa,+BAAgCgB,GAC5E0B,IAAShB,OACL,cAAC,EAAD,CAAK1B,YAAaA,EAAagB,yBAA0BA,IACzDoB,KAAKC,e,+BAzBb,WACI,OAAOL,OAAOC,OAAON,O,eAHDgB,cAgC5BC,eAAeC,OAAO,iBAAkBjB,K","file":"static/js/main.c6b51439.chunk.js","sourcesContent":["import axios from 'axios';\n\nconst strapiEndPoint = `${process.env.REACT_APP_STRAPI_API_URL}`;\nconst apiEndPoint = `${process.env.REACT_APP_PUBLIC_API_URL}/template/searchby/`;\n\nexport const getTemplate = async (searchby = 'code', searchTerm) => {\n    return await axios.get(`${apiEndPoint}${searchby}/${searchTerm}`)\n}\n\n/**\n * getTemplateById Search Template By Id.\n * @param {*} templateId : TemplateId.\n * @returns \n */\nexport const getTemplateById = async (templateId) => {\n    const { data } = await axios.get(`${process.env.REACT_APP_PUBLIC_API_URL}/template/${templateId}`);\n    return data;\n}\n\n/**\n * getContentById Search Content By Id.\n * @param {*} contentType \n * @param {*} contentId \n * @returns \n */\n export const getContentById = async (contentName, contentId) => {\n    if (!contentName || !contentId) console.error(contentName, contentId);\n    const url = `${strapiEndPoint}/content-manager/collection-types/api::${contentName}.${contentName}/${contentId}`;\n    const { data } = await axios.get(url, addAuthorizationRequestConfig({}, 'EntKcToken'))\n\n    return data;\n}\n\nconst getKeycloakToken = () => {\n    return '';\n    if (window && window.entando && window.entando.keycloak && window.entando.keycloak.authenticated) {\n        return window.entando.keycloak.token\n    } else {\n        return localStorage.getItem('token');\n    }\n}\n\nconst getDefaultOptions = (defaultBearer) => {\n    const token = getKeycloakToken()\n    console.log('ET-Widget',token);\n    if (!token) {\n        //Below if condition is to run the strapi API in local\n        if (defaultBearer === 'EntKcToken') {\n            return {\n                headers: {\n                    Authorization: `Bearer ${'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiaWF0IjoxNjUyMzY5ODE4LCJleHAiOjE2NTQ5NjE4MTh9.Qwx9gGH33AzgIzSw12xGFy7pyWeHliGAl7-Bgt23Vg0'}`\n                },\n            }\n        } else {\n            return {}\n        }\n    }\n    // logic to add token for both strapi and MS api\n    return {\n        headers: {\n            Authorization: `${defaultBearer} ${token}`,\n        },\n    }\n}\n\n// Get authorization tokens\nexport const addAuthorizationRequestConfig = (config = {}, defaultBearer = 'Bearer') => {\n    let defaultOptions = getDefaultOptions(defaultBearer);\n    return {\n        ...config,\n        ...defaultOptions\n    }\n}","import React, { useEffect, useRef, useState } from 'react';\nimport { getContentById, getTemplateById } from './api/Api';\nvar velocityjs = require(\"velocityjs\");\nimport './app.css';\n\nconst domain = process.env.REACT_APP_STRAPI_API_URL;\n\nfunction App({ contentName, contentIdsAndTemplateIds }) {\n    console.log(\"contentName, contentIdsAndTemplateIds App==>\",contentName, contentIdsAndTemplateIds);\n    const [templateData, setTemplateData] = useState(null);\n    const [contentData, setContentData] = useState(null);\n    const [htmlCode, setHtmlCode] = useState(null);\n\n    useEffect(async () => {\n        const getTemplate = await getTemplateById(52);\n        const getContent = await getContentById('banner', 1);\n        setTemplateData(getTemplate);\n        setContentData(getContent)\n\n        // TODO: VELOCITY START\n\n        // TODO: for regex htmlCode.replace('/') \n        // var s = '<div id=\"myDiv\"></div>';\n        // var temp = document.createElement('div');\n        // temp.innerHTML = htmlCode;\n        // var htmlObject = temp.firstChild;\n        // htmlObject.querySelectorAll('img').forEach(\n        //     (el) => {\n        //         console.log('IMG', el);\n        //         // if (el.src.startsWith('$')) {\n        //             let templink = el.src\n        //             el.src = `${templink}`\n        //         // }\n        //     }\n        // );\n        // TODO: MAY-12\n        if (getContent && getTemplate) {\n            console.log(\"getContent\",getContent);\n            console.log(\"getTemplate.contentShape\",getTemplate.contentShape);\n\n            const veloResult = velocityjs.render(getTemplate.contentShape, getContent);\n            setHtmlCode(veloResult);\n        }\n\n        // TODO: VELOCITY END\n\n    }, [])\n    return (\n        <> \n        <h1>Static Component</h1> \n        <h1>{contentName, contentIdsAndTemplateIds}</h1>\n            {/* {\n                htmlCode ?\n                    <div dangerouslySetInnerHTML={{\n                        __html: htmlCode\n                    }}>\n                    </div> : <h1>Loading...</h1>\n            } */}\n        </>\n    );\n}\n\nexport default App;\n","import ReactDOM from \"react-dom\"\nimport React from \"react\"\nimport App from '../App'\n\nconst ATTRIBUTES = {\n    contentName: \"contentName\",\n    contentIdsAndTemplateIds: \"contentIdsAndTemplateIds\"\n};\n\nclass WidgetElement extends HTMLElement {\n\n    static get observedAttributes() {\n        return Object.values(ATTRIBUTES);\n    }\n\n    attributeChangedCallback(name, oldValue, newValue) {\n        if (!Object.values(ATTRIBUTES).includes(name)) {\n            throw new Error(`Untracked changed attribute: ${name}`);\n        }\n        if (this.mountPoint && newValue !== oldValue) {\n            this.render();\n        }\n    }\n\n    connectedCallback() {\n        this.mountPoint = document.createElement('div');\n        this.appendChild(this.mountPoint);\n        this.render();\n    }\n\n    render() {\n        const contentName = this.getAttribute(ATTRIBUTES.contentName);\n        const contentIdsAndTemplateIds = this.getAttribute(ATTRIBUTES.contentIdsAndTemplateIds);\n        console.log(\"contentName ==>\", contentName, \"contentIdsAndTemplateIds ==>\", contentIdsAndTemplateIds);\n        ReactDOM.render(\n            <App contentName={contentName} contentIdsAndTemplateIds={contentIdsAndTemplateIds} />,\n            this.mountPoint\n        );\n    }\n}\n\ncustomElements.define('my-list-widget', WidgetElement);\n\nexport default WidgetElement;\n\n"],"sourceRoot":""}